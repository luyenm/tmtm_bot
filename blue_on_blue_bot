import discord as ds
import os
from tokens import KEY, TOKEN, CLIENT
import Administrative.channel_filter as cf
import Administrative.user_verification as uv


key = KEY
token = TOKEN
client_id = CLIENT

client = ds.Client()

@client.event
async def on_read():
    print("Started")

# TODO: User verification

@client.event
async def on_message(message):
    # Checks if the message printed is from the original user.
    if message.author != client.user:
        if cf.checkphrase(message):
            bad_user = str(message.author)
            caught_phrase = str(message.content)
            channel = str(message.channel)
            timestamp = str(message.timestamp)
            bad_message = bad_user, channel, caught_phrase, timestamp
            await client.send_message(message.channel, bad_message)

        if message.content[:2] == '.?':
            request = message.content[2:]
            if 'verify' in request:
                uv.verify_user(request.rsplit('/', 1)[-1])
            await client.send_message(message.channel, "Prompt seen.")

        # await client.send_message(message.channel, message.content[::-1])



client.run(token)


# Sets up the client
# async def setup()
